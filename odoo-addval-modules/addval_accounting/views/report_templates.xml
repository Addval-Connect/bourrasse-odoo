<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="custom_header">
        <div class="o_boxed_header">
            <t t-set="report_number" t-value="header_data['report_number']" />
            <t t-set="report_name" t-value="header_data['report_name'].title()" />
            <t t-set="header_address" t-value="header_data['header_address']" />
            <t t-set="custom_footer">
                <t t-call="l10n_cl.custom_footer" />
            </t>
            <div>
                <div class="row">
                    <div name="left-upper-side" class="col-8">
                        <img t-if="header_data.get('company_logo',None)" t-att-src="image_data_uri(header_data['company_logo'])" style="max-height: 60px;" alt="Logo" />
                        <br t-if="header_data.get('company_logo',None)" />
                        <strong>
                            <span t-esc="header_data['company_name'].title()" />
                        </strong>
                        <br />
                        <span name="company_activity" class="font-italic" t-if="header_data.get('company_activity',None)" t-esc="header_data['company_activity'].title()" />
                        <div />
                        <t t-esc="' - '.join([item for item in [', '.join([item for item in [header_address.street, header_address.street2, header_address.city, header_address.state_id.name] if item]), header_address.country_id.name] if item]).title()" />
                        <span t-if="header_address.phone">
                            <br />
                        </span>
                        <span t-if="header_address.phone" style="white-space: nowrap;" t-esc="'Tel: ' + header_address.phone" />
                        <span t-if="header_address.website">
                            <span t-att-style="'color: %s;' % header_data['primary_color']" t-esc="'- Web: %s' %' - '.join([item for item in [header_address.website.replace('https://', '').replace('http://', ''), header_address.email] if item])" />
                        </span>
                    </div>
                    <div name="right-upper-side" class="col-4">
                        <div class="row">
                            <div name="right-upper-side" class="col-12">
                                <div class="row border border-dark">
                                    <div class="col-12 text-center">
                                        <h6 t-att-style="'color: %s;' % header_data['primary_color']">
                                            <strong t-att-style="'color: %s;' % header_data['primary_color']">
                                                <br />
                                                <span style="line-height: 180%;">RUT:</span>
                                                <span t-esc="header_data['company_vat']" />
                                                <br />
                                                <span class="text-uppercase" t-esc="report_name" />
                                                <br />
                                                <span>Nº:</span>
                                                <span style="line-height: 200%;" t-esc="report_number" />
                                                <br />
                                                <br />
                                            </strong>
                                        </h6>
                                    </div>
                                </div>
                                <div class="row text-center">
                                    <div t-if="header_data.get('regional_office',None)" class="col-12 text-center" t-att-style="'color: %s;' % header_data['primary_color']" name="regional-office">
                                        <span t-esc="header_data['regional_office'].title()" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <template id="invoice_data">
        <t t-set="invoice_address" t-value="invoice_data['address']" />
        <div id="invoice_data" class="row border border-dark" style="margin-left: 0.25px; margin-right: 0.25px;">
            <div id="company_information" class="col-6">
                <div class="row">
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Razón Social:</span>
                        </strong>
                        <span t-esc="invoice_data['company_name'].title()" />
                    </div>
                </div>
                <div class="row" t-if="invoice_data.get('company_vat',None) and invoice_data['latam_identification_type_id']">
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Rut:</span>
                        </strong>
                        <span t-esc="invoice_data['company_vat']" />
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Dirección:</span>
                        </strong>
                        <span t-esc="' - '.join([item for item in [', '.join([item for item in [invoice_address.street, invoice_address.street2, invoice_address.city, invoice_address.state_id.name] if item]), invoice_address.country_id.name] if item]).title()" />
                    </div>
                </div>
                <div class="row" t-if="invoice_data.get('activity_description',None)">
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Giro:</span>
                        </strong>
                        <span t-esc="invoice_data['activity_description'].title()" />
                    </div>
                </div>
            </div>
            <div id="invoice_information" class="col-6">
                <div class="row" t-if="invoice_data.get('invoice_date',None)">
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Fecha:</span>
                        </strong>
                        <span t-esc="invoice_data['invoice_date']" t-options='{"widget": "date"}' />
                    </div>
                </div>
                <div class="row" t-if="invoice_data.get('date_due',None)">
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Fecha de Vencimiento:</span>
                        </strong>
                        <span t-esc="invoice_data['date_due']" t-options='{"widget": "date"}' />
                    </div>
                </div>
                <div class="row" t-if="invoice_data.get('order_date',None)">
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Fecha del Pedido:</span>
                        </strong>
                        <span t-esc="invoice_data['order_date']" t-options='{"widget": "date"}' />
                    </div>
                </div>
                <div class="row" t-if="invoice_data.get('order_reference',None)">
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Referencia del Pedido:</span>
                        </strong>
                        <span t-esc="invoice_data['order_reference']" />
                    </div>
                </div>
                <div class="row" t-if="invoice_data.get('order_representative',None)">
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Representante de Compra:</span>
                        </strong>
                        <span t-esc="invoice_data['order_representative']" />
                    </div>
                </div>
                <div class="row" t-if="invoice_data.get('sale_representative',None)">
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Comercial:</span>
                        </strong>
                        <span t-esc="invoice_data['sale_representative']" />
                    </div>
                </div>
                <div class="row" t-if="invoice_data.get('shipping_address',None)">
                    <t t-set="shipping_address" t-value="invoice_data['shipping_address']" />
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Dirección de Entrega:</span>
                        </strong>
                        <span t-esc="' - '.join([item for item in [', '.join([item for item in [shipping_address.street, shipping_address.street2, shipping_address.city, shipping_address.state_id.name] if item]), shipping_address.country_id.name] if item]).title()" />
                    </div>
                </div>
                <div class="row" t-if="invoice_data.get('payment_term',None)">
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Plazos de pago:</span>
                        </strong>
                        <span t-esc="invoice_data.get('payment_term','').title()" />
                    </div>
                </div>
                <div class="row" t-if="invoice_data.get('incoterm',None)">
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Incoterm:</span>
                        </strong>
                        <span t-esc="invoice_data['incoterm']" />
                    </div>
                </div>
                <div class="row" t-if="invoice_data.get('delivery_reason',None)">
                    <div class="col">
                        <strong>
                            <span t-att-style="'color: %s;' % invoice_data['secondary_color']">Razón de Transferencia:</span>
                        </strong>
                        <span t-esc="invoice_data['delivery_reason']" />
                    </div>
                </div>
            </div>
        </div>
        <hr class="mb-1" style="border-top: 0px" />
        <t id="references" t-if="o.l10n_cl_reference_ids">
            <table class="table table-sm o_main_table small" name="invoice_references">
                <thead>
                    <tr>
                        <th name="th_reference_origin" class="text-center">
                            <span>Origin Ref</span>
                        </th>
                        <th name="th_reference_doc_type" class="text-left">
                            <span>Reference Doc Type</span>
                        </th>
                        <th name="th_reference_code" class="text-center">
                            <span>Doc Code</span>
                        </th>
                        <th name="th_reference_reason" class="text-left">
                            <span>Reason</span>
                        </th>
                        <th name="th_reference_date" class="text-left">
                            <span>Date</span>
                        </th>
                    </tr>
                </thead>
                <tbody class="invoice_tbody">
                    <t t-foreach="o.l10n_cl_reference_ids" t-as="refs">
                        <tr>
                            <td class="text-left" name="td_reference_origin">
                                <span t-field="refs.origin_doc_number" />
                            </td>
                            <td class="text-left" name="td_reference_doc_type">
                                <span t-field="refs.l10n_cl_reference_doc_type_selection" />
                            </td>
                            <td class="text-left" name="td_reference_code">
                                <span t-field="refs.reference_doc_code" />
                            </td>
                            <td class="text-left" name="td_reference_reason">
                                <span t-field="refs.reason" />
                            </td>
                            <td class="text-left" name="td_reference_date">
                                <span t-field="refs.date" />
                            </td>
                        </tr>
                    </t>
                </tbody>
            </table>
            <hr class="mb-1" style="border-top: 0px" />
        </t>
    </template>

    <template id="transferable_table">
        <div name="transferable-table" class="col-6 mt-3" style="page-break-inside: avoid;">
            <div class="border border-dark p-1">
                <div class="row">
                    <div class="col text-justify" style="font-size: 9px; padding-top: 1px; white-space: nowrap; overflow: hidden; text-overflow: clip;">
                        <strong>NOMBRE:</strong> .......................................................................................................................................................................
                    </div>
                </div>
                <div class="row">
                    <div class="col text-justify" style="font-size: 9px; padding-top: 1px; white-space: nowrap; overflow: hidden; text-overflow: clip;">
                        <strong>RUT:</strong> .................................................................................................................................................................................
                    </div>
                </div>
                <div class="row">
                    <div class="col text-justify" style="font-size: 9px; padding-top: 1px; white-space: nowrap; overflow: hidden; text-overflow: clip;">
                        <strong>FECHA:</strong> ...........................................................................................................................................................................
                    </div>
                </div>
                <div class="row">
                    <div class="col text-justify" style="font-size: 9px; padding-top: 1px; white-space: nowrap; overflow: hidden; text-overflow: clip;">
                        <strong>RECINTO:</strong> .......................................................................................................................................................................
                    </div>
                </div>
                <div class="row">
                    <div class="col text-justify" style="font-size: 9px; padding-top: 1px; white-space: nowrap; overflow: hidden; text-overflow: clip;">
                        <strong>FIRMA:</strong> ............................................................................................................................................................................
                    </div>
                </div>
                <p style="font-size: 8px;" class="text-justify mt-1">El acuse de recibo que se declara
                    en este acto, de acuerdo a lo
                    dispuesto en la letra b) del Artículo 4°, y
                    la letra c) del Artículo 5° de la Ley 19.983, acredita que
                    la entrega de mercaderías o servicio(s) prestado(s)
                    ha(n) sido recibido(s).
                </p>
            </div>
        </div>
    </template>
    <template id="important_notes">
        <div name="important notes" class="col-12 mt-3 p-2 border border-dark" style="page-break-inside: avoid;">
            <div class="row">
                <div class="col text-left" style="font-size: 10px; padding-top: 1px;">
                    <strong>Notas Importantes:</strong>
                </div>
            </div>
            <div class="row">
                <div class="col text-justify" style="font-size: 10px; padding-top: 1px;">
                    1.- En la factura XML hacer referencia a la orde de compra (COD 801) y enviar al correo <span t-esc="o.company_id.l10n_cl_dte_email" t-options='{"widget": "email"}' />
, de lo
                    contrario será rechazada automáticamente.
                </div>
            </div>
            <div class="row">
                <div class="col text-justify" style="font-size: 10px; padding-top: 1px;">
                    2.- Los pagos se efectuarán según lo dispuesto en la orden de compra.
                </div>
            </div>
        </div>
    </template>
    <template id="notes">
        <div name="notes" class="col-6 p-2 ml-3 border border-dark" style="page-break-inside: avoid;">
            <div class="row">
                <div class="col text-left" style="font-size: 10px; padding-top: 1px;">
                    <strong>Observaciones:</strong>
                </div>
            </div>
            <div class="row">
                <div class="col text-justify" style="font-size: 10px; padding-top: 1px;">
                    <span t-field="o.notes" />
                </div>
            </div>
        </div>
    </template>
</odoo>